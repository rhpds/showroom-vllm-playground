= Module 3: Tool calling for intelligent automation
:source-highlighter: rouge
:toc: macro
:toclevels: 1

In Module 2, ACME learned to constrain AI outputs to specific formats. Now they want to take customer support to the next level: enabling AI to not just respond, but to take actions - looking up order status, checking inventory, or scheduling callbacks.

Tool calling (also known as function calling) allows the AI to recognize when it needs external data or actions, and generate structured function calls that your systems can execute. This module demonstrates how ACME configures tool calling and defines custom tools for customer support scenarios.

**Critical understanding**: Tool calling does NOT mean the LLM executes tools. The AI generates JSON-formatted function calls with arguments, but your application (vLLM Playground) is responsible for parsing and executing them. This design ensures security and gives you full control over actions.

**Presenter note**: For 30-45 minute demos, focus on Part 1 showing 2-3 tools. This module is essential for demonstrating how AI goes beyond text generation to become an intelligent assistant.

== Part 1 â€” Enabling tool calling for intelligent automation

=== Know

_ACME Corporation's AI customer support is limited to providing text responses. Support agents still manually look up order status, check inventory, and schedule callbacks. This creates delays and frustration for customers who expect AI to "just handle it."_

**Business challenge**: AI that can act, not just chat

* Current AI only generates text responses - agents manually execute actions
* Customer inquiries requiring data lookup (order status, account info) force handoffs to agents
* Simple requests like "schedule a callback" still need human intervention
* No integration between AI conversation and backend systems (CRM, ERP, order management)

**Current state limitations**:

* **AI-to-human handoff delays**: 60-80% of inquiries need agent action after AI diagnosis
* **No real-time data access**: AI cannot check order status, inventory, or account information
* **Manual task execution**: Agents manually schedule callbacks, create tickets, update records
* **Disconnected systems**: AI conversation exists separately from operational systems

**Desired state transformation**:

* AI generates structured function calls when customers ask about orders or accounts
* Backend systems execute these calls and return real data to the AI conversation
* Simple actions (callback scheduling, ticket creation) happen automatically
* Seamless integration between AI conversation and enterprise systems

**Business value proposition**:

Tool calling transforms AI from a chatbot into an intelligent assistant that can interact with backend systems. ACME's AI can now check order status, retrieve account information, and schedule actions - all within the conversation flow.

**Quantified business impact**:

* **60-80% reduction in agent handoffs**: AI handles data lookup and simple actions automatically
* **Faster resolution times**: Order status checks happen in seconds instead of minutes (agent lookup)
* **Improved customer satisfaction**: Customers get answers without waiting for agent availability
* **Backend integration**: Single conversation accesses CRM, order management, inventory systems

**Stakeholder impact**:

* **Customer Support Leaders**: Reduce agent workload by automating routine data lookups
* **IT Integration Teams**: Standard function calling pattern works across all backend APIs
* **Customer Experience**: Seamless AI-to-system integration feels like talking to an expert agent
* **Operations**: Real-time data access ensures accurate information in every response

=== Show

**Presenter guidance**: Demonstrate how ACME's AI goes from text-only responses to generating function calls that interact with backend systems. Emphasize the business transformation.

**What to demonstrate**:

. **Access vLLM Playground** (15 seconds):
+
Open browser to: http://{hostname}:7860
+
**Business context**: "We're continuing from Module 2. Now we'll configure the AI to call tools - enabling it to access backend data and take actions."

. **Stop current server and enable tool calling** (2 minutes):
+
**If server is running** - click *Stop Server*
+
**In Server Configuration panel**:
+
* Check *Enable Tool Calling* checkbox
* Select tool calling parser: `hermes` or `Auto-detect`
* Model: `Qwen/Qwen2.5-3B-Instruct` (same as Module 2 if already deployed)
* Click *Start Server*
* Wait for green "Server is ready!" notification
+
image::module-03-figure-01.png[Server configuration with tool calling enabled,width=500,title="Enable Tool Calling"]
+
**Business talking point**: "Enabling tool calling allows the AI to recognize when it needs external data and generate function calls. Different model families use different formats - Qwen uses Hermes-style, Llama uses llama3_json, Mistral has its own format."

. **Navigate to Tools panel** (15 seconds):
+
**Click the Tools icon (ðŸ”§) in the toolbar**
+
**Business context**: "This is where ACME defines the tools (functions) their AI can call. Each tool represents a backend API or system capability."
+
image::module-03-figure-02.png[Tools definition panel,width=600,title="Tools Panel"]

. **Define order status lookup tool** (3-4 minutes):
+
**Click Add Tool**
+
**Define the function**:
+
[source,json]
----
{
  "type": "function",
  "function": {
    "name": "get_order_status",
    "description": "Look up the current status of a customer order. Use this when a customer asks about their order, shipping, or delivery.",
    "parameters": {
      "type": "object",
      "properties": {
        "order_id": {
          "type": "string",
          "description": "The order ID to look up (e.g., ORD-12345)"
        }
      },
      "required": ["order_id"]
    }
  }
}
----
+
image::module-03-figure-03.png[Order status lookup tool definition,width=600,title="Order Status Lookup Tool"]
+
**Business talking point**: "This tool definition tells the AI: 'When a customer asks about order status, generate a function call to get_order_status with the order_id parameter.' The description helps the AI decide when to use this tool."

. **Define customer information retrieval tool** (2 minutes):
+
**Add second tool**:
+
[source,json]
----
{
  "type": "function",
  "function": {
    "name": "get_customer_info",
    "description": "Retrieve customer account information. Use this when you need to verify customer identity or look up account details.",
    "parameters": {
      "type": "object",
      "properties": {
        "customer_email": {
          "type": "string",
          "description": "Customer's email address"
        }
      },
      "required": ["customer_email"]
    }
  }
}
----
+
**Business talking point**: "This tool connects to ACME's CRM. When the AI needs account information, it generates a function call with the customer's email."

. **Define callback scheduling tool** (2 minutes):
+
**Add third tool**:
+
[source,json]
----
{
  "type": "function",
  "function": {
    "name": "schedule_callback",
    "description": "Schedule a callback from a support agent. Use this when the customer requests to speak with a human or needs escalated support.",
    "parameters": {
      "type": "object",
      "properties": {
        "customer_phone": {
          "type": "string",
          "description": "Customer's phone number for callback"
        },
        "preferred_time": {
          "type": "string",
          "description": "Preferred callback time (e.g., 'morning', 'afternoon', '2pm EST')"
        },
        "issue_summary": {
          "type": "string",
          "description": "Brief summary of the customer's issue"
        }
      },
      "required": ["customer_phone", "issue_summary"]
    }
  }
}
----
+
**Business talking point**: "Callback scheduling was always manual - agents had to enter this data into ticketing systems. Now the AI extracts the information and generates the function call automatically."

. **Test tool calling workflow** (4-5 minutes):
+
**Navigate to Chat interface**
+
**Send customer inquiry**:
+
----
Hi, I'm checking on my order ORD-45892. It's been a week and I haven't received any updates. Can you tell me where it is?
----
+
**What they'll see** - AI generates function call:
+
[source,json]
----
{
  "name": "get_order_status",
  "arguments": {
    "order_id": "ORD-45892"
  }
}
----
+
**Business value callout**: "Notice what happened. The AI understood the customer's question, extracted the order ID, and generated a function call. In production, ACME's system would execute this call against their order management API and return real status data to the conversation."
+
**Point out the function call display** in the chat interface
+
**Business talking point**: "The AI didn't just respond with text - it generated a structured function call that ACME's backend can execute. This is the foundation for AI-to-system integration."

. **Test multiple tool scenario** (2-3 minutes):
+
**Send escalation request**:
+
----
This is unacceptable. I need someone to call me back today. My number is 555-0123 and I need to speak with a manager. This order was supposed to arrive for my daughter's birthday.
----
+
**What they'll see** - AI generates callback scheduling call:
+
[source,json]
----
{
  "name": "schedule_callback",
  "arguments": {
    "customer_phone": "555-0123",
    "preferred_time": "today",
    "issue_summary": "Delayed order ORD-45892, customer upset, needs manager callback"
  }
}
----
+
**Business talking point**: "The AI recognized this needs escalation, extracted the phone number, understood urgency, and generated a callback request. ACME's ticketing system receives this structured data and creates a high-priority callback task automatically."

. **Demonstrate tool selection intelligence** (2 minutes):
+
**Send different type of inquiry**:
+
----
I forgot my account password and need to verify my account. My email is customer@example.com
----
+
**What they'll see**:
+
[source,json]
----
{
  "name": "get_customer_info",
  "arguments": {
    "customer_email": "customer@example.com"
  }
}
----
+
**Business talking point**: "The AI chose the right tool for this scenario - customer information lookup, not order status. This intelligence comes from the tool descriptions and the model's understanding of context."

**Business value summary**:

"What you've seen is how ACME transforms their AI from a text generator into an intelligent assistant that interacts with backend systems. The AI now handles order lookups, schedules callbacks, and retrieves account information - all within the conversation. This reduces agent workload by 60-80% for routine inquiries."

**Troubleshooting scenarios to be ready for**:

**Q: "How do we secure tool execution? Can the AI call any function?"**
â†’ A: Tool definitions are configured by administrators - the AI can only call tools you explicitly define. In production, you'd add authentication and authorization checks before executing function calls.

**Q: "What if the AI generates invalid function arguments?"**
â†’ A: Tool definitions include parameter schemas with types and requirements. The AI generates arguments matching this schema. Your backend should still validate before execution.

**Q: "How does this integrate with our existing APIs?"**
â†’ A: The AI generates standard JSON function calls. Your middleware maps these to your API endpoints - REST, GraphQL, internal services. The pattern works with any backend.

**Q: "What about execution and results?"**
â†’ A: This module shows function call generation. Module 4 (MCP Integration) demonstrates the full execution cycle with human-in-the-loop approval and results returning to the AI.

== Part 2 â€” Advanced tool patterns (Optional - 60min demo)

=== Know

_For complex customer support scenarios, ACME needs more sophisticated tools: product search with filters, inventory checks, order modifications, and multi-step workflows._

**Advanced tool capabilities**:

* **Complex parameters**: Multiple optional fields, nested objects, array parameters
* **Tool chaining**: AI generates multiple tool calls in sequence
* **Conditional logic**: AI chooses different tools based on customer needs
* **Error handling**: AI responds appropriately when tool calls fail

=== Show

**Presenter guidance** (only for 60min deep dive): Demonstrate advanced tool patterns like product search with filters.

. **Define product search tool with filters** (2-3 minutes):
+
[source,json]
----
{
  "type": "function",
  "function": {
    "name": "search_products",
    "description": "Search for products in the catalog. Use this when customers ask about product availability, features, or pricing.",
    "parameters": {
      "type": "object",
      "properties": {
        "query": {
          "type": "string",
          "description": "Search keywords"
        },
        "category": {
          "type": "string",
          "enum": ["electronics", "clothing", "home", "sports"],
          "description": "Product category filter"
        },
        "max_price": {
          "type": "number",
          "description": "Maximum price filter"
        }
      },
      "required": ["query"]
    }
  }
}
----
+
**Business talking point**: "Product search shows advanced parameters - required query, optional category filter, optional price filter. The AI decides which parameters to use based on the customer's question."

. **Test advanced search** (2 minutes):
+
**Send query**: "I'm looking for wireless headphones under $100"
+
**Expected function call**:
+
[source,json]
----
{
  "name": "search_products",
  "arguments": {
    "query": "wireless headphones",
    "category": "electronics",
    "max_price": 100
  }
}
----
+
**Business talking point**: "The AI extracted the product type, inferred the category, and captured the price limit. This structured search query goes directly to ACME's product catalog API."

**Business value summary for advanced tools**:

"Advanced tool patterns enable ACME to handle complex customer interactions - multi-parameter searches, conditional workflows, and sophisticated business logic - all through natural conversation."

== Demonstration outcomes

By seeing this demonstration, audiences should understand:

* âœ“ How tool calling transforms AI from text generation to intelligent automation
* âœ“ The business impact of reducing agent handoffs by 60-80%
* âœ“ How function definitions enable AI-to-backend system integration
* âœ“ Real-world application to customer support workflows (orders, callbacks, account lookup)
* âœ“ The pattern for integrating AI with existing enterprise APIs

== Module summary

**What ACME accomplished**:

* Enabled tool calling in vLLM server configuration
* Defined custom tools for order status, customer info, and callback scheduling
* Demonstrated AI-generated function calls for backend system integration
* (Optional) Showed advanced tool patterns with filters and complex parameters

**Key takeaways for technical audiences**:

* Tool calling enables AI to interact with backend systems through structured function calls
* Tool definitions use JSON Schema for parameters - same pattern as Module 2
* The AI decides which tool to call based on descriptions and conversation context
* Your application controls execution - AI only generates the function calls

**Business value delivered**:

* **60-80% reduction in agent handoffs**: AI handles routine data lookups automatically
* **Faster resolution**: Order status in seconds vs minutes of agent lookup
* **Backend integration**: Single pattern works across CRM, ERP, order management, inventory
* **Improved CX**: Customers get answers without waiting for agent availability

**Next module preview**:

Module 4 explores *MCP Integration* - the full execution cycle for tool calling. You'll see how ACME implements human-in-the-loop approval, executes tools safely, and returns results to the AI conversation. This demonstrates production-ready agentic workflows with enterprise controls.
